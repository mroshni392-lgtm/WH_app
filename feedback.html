<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Feedback - HeatMap App</title>
  <style>
    body { font-family: 'Poppins', sans-serif; background: linear-gradient(135deg, #1e293b, #0f172a); color: #f8fafc; margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; transition: background 0.5s ease, color 0.5s ease; }
    body.light { background: linear-gradient(135deg, #f8fafc, #e2e8f0); color: #1e293b; }
    body.ocean { background: linear-gradient(135deg, #0a2540, #012a4a); color: #cce4f6; }
    h1 { margin-bottom: 20px; color: #38bdf8; }
    .stars { display: flex; gap: 10px; font-size: 40px; cursor: pointer; margin-bottom: 20px; }
    .star { transition: transform 0.2s; }
    .star:hover { transform: scale(1.3); }
    .emoji { font-size: 50px; margin-bottom: 20px; display: block; }
    .feedback-input { width: 300px; padding: 10px; border-radius: 6px; border: none; margin-bottom: 15px; outline: none; }
    .submit-btn { background-color: #38bdf8; color: #0f172a; border: none; padding: 10px 20px; border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
    .submit-btn:hover { background-color: #0ea5e9; }
    .message { text-align: center; margin-top: 20px; font-size: 18px; }
  </style>
</head>
<body>

  <h1>Rate Our App</h1>
  <div class="stars" id="stars">
    <span class="star" data-value="1">‚òÖ</span>
    <span class="star" data-value="2">‚òÖ</span>
    <span class="star" data-value="3">‚òÖ</span>
    <span class="star" data-value="4">‚òÖ</span>
    <span class="star" data-value="5">‚òÖ</span>
  </div>
  <span class="emoji" id="emoji">üòê</span>

  <div id="feedbackDiv" style="display:none;">
    <input type="text" id="issueInput" class="feedback-input" placeholder="Tell us the problem...">
    <button class="submit-btn" onclick="submitIssue()">Submit</button>
  </div>

  <div class="message" id="messageDiv"></div>

<script>
  // Apply theme from settings
  (function applyTheme() {
    const theme = localStorage.getItem("theme");
    if (theme === "Light Mode") document.body.classList.add("light");
    else if (theme === "Ocean Blue") document.body.classList.add("ocean");
  })();

  let rating = 0;
  const emojiMap = {
    1: "üò°",
    2: "üòü",
    3: "üòê",
    4: "üôÇ",
    5: "üòç"
  };

  const starsEl = document.getElementById("stars");
  const emojiEl = document.getElementById("emoji");
  const feedbackDiv = document.getElementById("feedbackDiv");
  const messageDiv = document.getElementById("messageDiv");

  starsEl.querySelectorAll(".star").forEach(star => {
    star.addEventListener("click", () => {
      rating = parseInt(star.getAttribute("data-value"));
      updateStars();
    });
  });

  function updateStars() {
    starsEl.querySelectorAll(".star").forEach(star => {
      const val = parseInt(star.getAttribute("data-value"));
      star.style.color = val <= rating ? "#facc15" : "#9ca3af";
    });
    emojiEl.textContent = emojiMap[rating] || "üòê";

    if (rating >= 4) {
      feedbackDiv.style.display = "none";
      showMessage(`Thank you for your response ‚ù§Ô∏è<br>Contact us for further issues at +91 ${Math.floor(6000000000 + Math.random()*1000000000)}`);
      redirectHome();
    } else if (rating > 0) {
      feedbackDiv.style.display = "block";
    }
  }

  function submitIssue() {
    const issue = document.getElementById("issueInput").value.trim();
    if(!issue) { alert("Please tell us the problem!"); return; }
    feedbackDiv.style.display = "none";
    showMessage(`Thank you for your response ‚ù§Ô∏è<br>We will try to rectify the issue.<br>Contact for further issues: +91 ${Math.floor(6000000000 + Math.random()*1000000000)}`);
    redirectHome();
  }

  function showMessage(msg) {
    messageDiv.innerHTML = msg;
  }

  function redirectHome() {
    setTimeout(() => {
      window.location.href = "index.html";
    }, 5000); // redirect after 5 seconds
  }
</script>

</body>
</html>
